---
import { useTranslations, getLangFromUrl } from "@/i18n/utils";
const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
---

<script type="module" client:load>
  async function subscribe(e) {
    e.preventDefault();
    const input = document.querySelector("#newsletter-email");
    const email = input.value;
    const msgBox = document.querySelector("#subscribe-msg");
    msgBox.textContent = "";

    if (!email) return (msgBox.textContent = "Please enter an email");

    try {
      const res = await fetch("/api/subscribe", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ email }),
      });

      if (!res.ok) throw new Error(await res.text());
      msgBox.textContent = "üéâ Subscribed successfully!";
      input.value = "";
    } catch (err) {
      msgBox.textContent = `‚ùå ${err.message}`;
    }
  }
</script>

<div class="px-4 bg-black w-full">
  <div class="bg-black text-white min-h-screen flex flex-col justify-between lg:container mx-auto py-12">
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
      <div class="mt-4 lg:mt-8">
        <span class="text-2xl lg:text-3xl">{t("footer.subscribe-to-our-newsletter")}</span>
        <form class="border-b mt-4 pb-2 flex items-center" onSubmit="subscribe(event)">
          <input
            id="newsletter-email"
            type="email"
            placeholder={t("footer.mailing-address")}
            class="bg-black w-full text-white outline-none placeholder-stone-400 text-lg"
            required
          />
          <button type="submit" class="ml-4 text-lg lg:text-xl">‚Üó</button>
        </form>
        <div id="subscribe-msg" class="mt-2 text-sm text-green-400"></div>
      </div>

      <!-- Contact -->
      <div class="grid grid-cols-1 lg:grid-cols-2 mt-4 lg:mt-8">
        <div class="hidden lg:block"></div>
        <div class="gap-y-4">
          <div class="text-lg">
            <span>hello@otherdev.com</span>
            <span>+92 315 6893331</span><br/>
            <span class="mt-2">- 78905 Karachi, Pakistan</span><br/>
            <span>- 75011 Chicago, Illinois</span>
          </div>
          <div class="mt-6 lg:mt-0 text-sm">
            <span>{t("footer.easter-egg")}</span>
            <span>¬©2025 The Other Dev</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Brand section -->
    <div class="flex flex-col relative overflow-hidden lg:flex-row items-center justify-between gap-6 mt-12">
      <h1 class="text-6xl queens-compressed lg:text-[15vw] font-serif tracking-tight leading-none text-left">
        {t("footer.bottom-big-text")}
      </h1>
      <div class="w-[20%] lg:w-[20%] hidden lg:block">
        <img inferSize={true} src="/shapes/Party.svg" loading="lazy" class="w-full h-auto object-contain" alt="Party Shape" />
      </div>
    </div>
  </div>
</div>
